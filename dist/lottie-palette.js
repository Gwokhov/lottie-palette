!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).LottiePalette=t()}(this,(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(){function n(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),!e)throw"[lottie-palette] No element found.";this.$element=e,this.colorMap={},this.linearGradMap={},this.updateMaps()}var r,a,o;return r=n,o=[{key:"_lineGradString2Data",value:function(e){return e.split("-").map((function(e){return e.split("|")}))}},{key:"_lineGradString2CSS",value:function(e){var t=n._lineGradString2Data(e),r=[];return t.forEach((function(e){var t="";t=e[2]?n._rgb2Rgba(e[1],e[2]):e[1],t+=" ".concat(e[0]),r.push(t)})),"".concat("linear-gradient(").concat(r.join(",")).concat(")")}},{key:"_rgb2Rgba",value:function(e,t){var n=e.substring(4,e.length-1);return"rgba(".concat(n,",").concat(t,")")}},{key:"_hex2Rgb",value:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?"rgb(".concat(parseInt(t[1],16),",").concat(parseInt(t[2],16),",").concat(parseInt(t[3],16),")"):""}}],(a=[{key:"updateMaps",value:function(){this._generateColorMap(),this._generateLineGradMap()}},{key:"_generateColorMap",value:function(){for(var e=this.$element.querySelectorAll('path[fill^="rgb"]'),t=0,n=e.length;t<n;t++){var r=e[t],a=window.encodeURIComponent(window.getComputedStyle(r).fill.replace(/\s+/g,""));a in this.colorMap?this.colorMap[a].push(r):this.colorMap[a]=[r]}}},{key:"_generateLineGradMap",value:function(){for(var e=this.$element.querySelectorAll("defs > linearGradient"),t=0,n=e.length;t<n;t++){for(var r=e[t],a=r.children,o=[],i=0,l=a.length;i<l;i++){var c=a[i],u=c.getAttribute("offset"),f=c.getAttribute("stop-color"),s=c.getAttribute("stop-opacity");o.push([u,f,s].join("|"))}var p=o.join("-");p in this.linearGradMap?this.linearGradMap[p].push(r):this.linearGradMap[p]=[r]}}},{key:"getInitialColors",value:function(){var e=[];for(var t in this.colorMap)this.colorMap.hasOwnProperty(t)&&e.push(window.decodeURIComponent(t));return e}},{key:"getLinearGradients",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"css",t=[];for(var r in this.linearGradMap){if(!this.linearGradMap.hasOwnProperty(r))return;var a=void 0;a="css"===e?n._lineGradString2CSS(r):r,t.push(a)}return t}},{key:"updateColor",value:function(e,t,r){var a=e.replace(/\s+/g,"");if(0!==a.indexOf("#")||4!==a.length&&7!==a.length){if(0!==a.indexOf("rgb("))throw"[lottie-palette] Color key ".concat(e," is invalid")}else a=n._hex2Rgb(a);var o=window.encodeURIComponent(e.replace(/\s+/g,""));if(!(o in this.colorMap))throw'No such color key "'.concat(e,'" in the origin svg file!');this.colorMap[o].forEach((function(e){e.style.fill=t.replace(/\s+/g,"")})),r&&this.updateLinearGradColor(e,t)}},{key:"updateLinearGradColor",value:function(t,r){var a=this,o=function(e){if(!a.linearGradMap.hasOwnProperty(e))return{v:void 0};var o=n._lineGradString2Data(e),i=[];o.forEach((function(e,n){e[1]===t&&i.push(n)})),i.length>0&&a.linearGradMap[e].forEach((function(e){i.forEach((function(t){e.children[t].setAttribute("stop-color",r)}))}))};for(var i in this.linearGradMap){var l=o(i);if("object"===e(l))return l.v}}},{key:"updateLinearGrad",value:function(e,t){if(!(e in this.linearGradMap))throw'No such linear gradient key "'.concat(e,'" in the origin svg file!');var r=n._lineGradString2Data(t.replace(/\s+/g,""));this.linearGradMap[e].forEach((function(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild);r.forEach((function(t){var n=document.createElementNS("http://www.w3.org/2000/svg","stop");n.setAttribute("offset",t[0]),n.setAttribute("stop-color",t[1]),n.setAttribute("stop-opacity",t[2]),e.appendChild(n)}))}))}}])&&t(r.prototype,a),o&&t(r,o),n}()}));
